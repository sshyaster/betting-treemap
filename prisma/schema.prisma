generator client {
  provider = "prisma-client"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Drawing {
  id        String   @id @default(cuid())
  userId    String
  coinId    String
  interval  String
  toolType  String
  points    Json     // Array of { price: number, time: number }
  color     String   @default("#3b82f6")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId, coinId, interval])
}

model CryptoSnapshot {
  id         String   @id @default(cuid())
  coinId     String
  price      Float
  marketCap  Float
  change24h  Float
  volume24h  Float    @default(0)
  snapshotAt DateTime @default(now())

  @@index([coinId, snapshotAt])
  @@unique([coinId, snapshotAt])
}

model MarketSnapshot {
  id           String   @id @default(cuid())
  marketId     String
  title        String
  platform     String
  category     String
  volume24hr   Float
  volume1wk    Float
  volume1mo    Float
  volumeAll    Float
  openInterest Float
  price        Float?
  snapshotAt   DateTime @default(now())

  @@index([platform, snapshotAt])
  @@index([marketId, snapshotAt])
}

model NewsArticle {
  id          String   @id @default(cuid())
  title       String
  url         String   @unique
  source      String
  category    String
  publishedAt DateTime
  archivedAt  DateTime @default(now())

  @@index([category, publishedAt])
  @@index([publishedAt])
}

model SavedArticle {
  id        String   @id @default(cuid())
  userId    String
  title     String
  url       String
  source    String
  category  String
  savedAt   DateTime @default(now())

  @@unique([userId, url])
  @@index([userId, savedAt])
}

model CryptoOHLC {
  id     String   @id @default(cuid())
  coinId String
  date   DateTime
  open   Float
  high   Float
  low    Float
  close  Float
  volume Float

  @@unique([coinId, date])
  @@index([coinId, date])
}
